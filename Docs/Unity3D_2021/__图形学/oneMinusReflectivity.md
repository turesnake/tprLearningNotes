# ================================================================ #
#            oneMinusReflectivity  计算原理
# ================================================================ #
这个值在 Built-In 管线, SRP 管线 中是相同处理的;



# reflectivity:
    意为: "在某个入射角度下, 直接反射光, 占据入射光总量的比值"
    (这个反射光, 就是 "镜面反射光" )

# 1- reflectivity:
    剩余的光, 占据入射光总量的比例;
    这些光进入了 材质体内, 一部分被彻底吸收, 一部分再次射出材质, 变成漫反射光;
    ---
    如果临时忽略掉 被材质彻底吸收的部分,
    也可将这个值理解为: "漫反射光 占入射光总量的比值"


# 0.04:  在任何入射角下, 电介质的反射率, 都不会低于 0.04;

    


# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++ #
#     Metallic 模式下:
#     oneMinusReflectivity 的计算原理
#     (线性颜色空间)
# --------------------------------------------------------- #

metallic 是用户自定义的变量,区间[0,1], 
    0 表示彻底为 电介质
    1 表示彻底为 金属

通过 metallic, 可以计算出 对应的 反射率:

    reflectivity = lerp( 0.04, 1, metallic );
                
意思很直观: 全电介质时值为 0.04, 全金属时最大值为 1;
所以:
    oneMinusReflectivity =
    1 - reflectivity = 1 - lerp( 0.04, 1, metallic );
                    = lerp( 0.96, 0, metallic );
                    = 0.96 + (0-0.96)*metallic;
                    = 0.96 - 0.96 * metallic;

# 这就是我们要的公式  oneMinusReflectivity = 0.96 - 0.96 * metallic;        


# ---------- 在 Built-In 管线中 --------- #

unity_ColorSpaceDielectricSpec.a = 0.96; (线性颜色空间)

可直接使用:
    half OneMinusReflectivityFromMetallic( half metallic );

计算 oneMinusReflectivity;



# ---------- 在 catlike SRP 管线中 --------- #
宏: MIN_REFLECTIVITY = 0.04;

可使用:
    float OneMinusReflectivity( float metallic );

计算 oneMinusReflectivity;





# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++ #
#   计算: 
#        镜反颜色
#        漫反射颜色
# --------------------------------------------------------- #

# === 镜反颜色:
    float3 specularColor = lerp (0.04, 材质albedo, metallic);

    电介质的 镜反光 趋于无色 (0.04, 0.04, 0.04)
    金属的 镜反光 是可有 丰富色相的

# == 漫反射颜色:
    float3 diffuseColor = 材质albedo * oneMinusReflectivity;


# ------------------------ #
# 诡异的是, 这两个值加起来不等于: 材质albedo;
    而是等于:
        0.04 - 0.04*m + 0.96*a + 0.04*a*m 
        (此处, a 和 m 是缩写)

# -1-:
当 a=0 时(材质为纯黑色),
    总和 = 0.04 - 0.04m
    ---
    若 m=0: 总和 = 0.04;
        可理解为: 纯黑的电介质, 依然能对外反射出 0.04 的能量 (镜反+漫反);
            毕竟 电介质的 镜反比值 永远不小于 0.04;

    若 m=1: 总和 = 0;
        可理解为: 纯黑的金属, 完全不向外释放任何能量 (镜反+漫反);
            全部能量都被吸收了

# -2-:
当 a=1 时(材质为纯白色),
    总和 = 1; (且 metallic 变量被抵消了)
    可理解为: 
        不管是金属还是电介质, 这个材质都完全不吸收光, 
        它的 镜反光 + 漫反光 完全等于 材质albedo;

# -3-:
当 m=0 时(材质为纯电介质):
    总和 = 0.04 + 0.96a;
    可理解为:
        不管材质是什么颜色, 始终保持 0.04 的最低能量外泄率;
        同时万一材质为纯白色, 也能保持能量守恒;
        ---
        当颜色不是白色时, 有一部分能量被材质吸收了;

# -4-:
当 m=1 时(材质为纯金属):
    总和 = a;
    可理解为:
        默认 纯金属材质 不吸收任何光, 
        它的 镜反光+漫反光 彻底等于 入射光;
        ----
        为什么会这样 ?????
    









