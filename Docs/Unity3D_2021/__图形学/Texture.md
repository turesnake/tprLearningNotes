# ================================================================ #
#            Texture 细节
# ================================================================ #




# ============================================== #
#         texture wrap mode 和 插值算法
#            会导致贴图边界错误
# ---------------------------------------------- #
对 texture 执行各种插值算法, 需要对一个 texel 的周边 texel 采样,
当这个计算用于 texture 边界上的 texels 时, 选用何种 wrap mode 就会得到不同的 视觉结果;

# -- Clampe
    此时, 边界 texel 在和相同的颜色进行插值, 最后等于没插值, 
    这会导致边界一圈 texel 有一点点小异样, 但不是很明显

# -- Repeat
    如果 头尾颜色差异较大, 此时边界 texel 插值出来的结果就会错得离谱,
    往往会在 UV [0,1] 边界处出现非常明显的边


# ============================================== #
#         sRGB (Color Texture)
# ---------------------------------------------- #
位于: texture Inspector

此选项默认为勾选;

勾选的texture, 其数据颜色将被认为位于 sRGB 空间中(gamma)
在 unity 加载此 texture 文件时, 会自动对它执行 伽马校正: v^2.2

但凡不是位于 HDR 空间中的 贴图文件, 我们都要为其勾选此选项.

部分类型的 texture 文件不应该勾选, 比如那些记录 smoothness, metalness 的贴图;
它们应该被直接读取原始值;







# ============================================== #
#         Fadeout MipMap
# ---------------------------------------------- #
在 texture inspector 中可开启, 
开启后会增加一个 "区间滑块", 左端表示 "衰减起点", 右端表示 "衰减终点",
随着衰减, texture 最终会渐渐变成一个 中灰色颜色;

此功能需要开启 mipmap

此功能主要用于 detail maps

# built-in, srp 都用此方法



# ============================================== #
#         Anisotropic filtering
#            Aniso Level
#           各向异性插值
# ---------------------------------------------- #

地面,地板等对象, 在特定视角下, 其 UV 两轴的压缩比例是不一样的;
而 mipmap 默认选择压缩比最大的那个值, 来作为总体压缩值, 这会导致 插值出来的 texture
显得很模糊;

texture Inspector - Aniso Level 就是用来改善此问题的.

此功能需要开启 mipmap

# -1-
    project settings - quality - Anisotropic Texture
    要么设置为 Per texture, 这样每个 texture 都可以管理自己的 Aniso Level
    要么设置为 Forced On, 此时, each texture's Aniso Level is set to at least 9.
    (当然, 若 texture inspector - Aniso Level 被设为0, 还是能关闭此功能)

# -2-
    设置 texture inspector - Aniso Level
    0 表示关闭此功能, 1 开始起效, 设置的值越高, "各向异性插值" 做得越好.

# === 空间存储成本不变, 但性能开销增大
从原理上看, "各向异性插值" 好像是在 mipmap 基础上, 又多生成了不少 256x128 这样的 长方形lvl;
但要注意, 这些 长方形lvl, 并不像 mipmap 各级lvl 那样是预先计算出来的, 
而是在运行时, 通过增加采样数 来实现的,
所以, 开启 Aniso filtering 功能的 texture, 存储空间并不会变大, 但会增加运行时 运算成本; 




# ============================================== #
#            splat map
# ---------------------------------------------- #
同时覆盖 泥土 和 沙砾 两种 texture, 用一个 float 值做 线性插值;
要么全泥土, 要么全沙砾, 要么中间线性过度. 

splat map 就是那个存储 [0f,1f] 插值值的 map, 
它看起来就像是将数堆颜料 拍溅 到画布上形成的效果, 因此而得名

splat map 不需要太高的分辨率 就能起效

splat map 可以是灰阶图, 也可以是 rgb图, 但存储的数据 并不是 颜色信息, 
而仅仅是 插值数据, 所以在被 unity 读取时, 应关闭 sRGB 转换; 
这样一来, 不管项目是 gamma 还是线性空间, 都可直接读取 texture 中的数据; 


# --- 颜色空间 和 blend 效果 ---
尽管 splat map 自己不位于 sRGB 空间, 但它 blend 的那些 texture 却位于.
在 gamma 和 linear 空间中, 最终 blend 出来的效果是不同的:
    gamma 空间 blend 出来的 两texture过渡地带, 会更暗一些;

不过这个问题不大, 可以不去处理它;


# --- RGB splat map ---
可支持 4 张 texture 之间的插值:
    -1- r 
    -2- g
    -3- b
    -4- 1-(r+g+b)

要求是, 此 RGB splat map 中的每个 texel, 其 r+g+b <= 1;

还可以让前三个值对应 3 张 texture, 最后一个值对应 纯黑色; 


# --- RGBA splat map ---
也是可行的, 原理类似
此时可支持 5 个插值通道


# --- 更多通道 ---
若想支持更多插值通道, 可使用多张 splat map, 
甚至可将其组成 texture array



