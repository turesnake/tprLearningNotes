# ================================================================//
#                  Graphics   Math
# ================================================================//
图形学 涉及的数学概念



# ---------------------------------------------- #
#            辐射度量学概念 
# ---------------------------------------------- #

-- Radiant Energy - 电磁辐射能量，
                    Q
					单位：焦耳 joule

-- Radiant flux   - 单位时间内的辐射能量,也可理解为功率，流明
					Φ = dQ/dt
					单位：瓦特 watt = 流明 lm lumen

-- intensity      - I
					每个 单位立体角(solid angle)的 流明
					随着半径r的变化，intensity 并不发生变化
                    因为 立体角 大小是 固定的
					I(ω) = dΦ/dω
					单位：W/sr = lm/sr = cd = candela
					---
					与 流明 的换算：
					I = Φ/4pi = flux/4pi
                    ---
                    随着 半径r 的增大，intensity 值不变

-- irradiance     - E
					单位面积 dA 上的 flux（流明度）
					(注意，这个单位面，要和光线方向相垂直)
					随着半径r的变化，irradiance 会发生变化
					E(x) = dΦ(x)/dA
					单位：W/m^2 = lm/m^2 = lux
                    ---
                    随着 半径r 的增大，intensity 值会缩小

-- radiance       - L
					(luminance 亮度)
					单位立体角，单位面积上的 flux（流明度）

					L(p,ω) = d^2Φ(p,ω) / dω * dA * cosΘ
					(此处的 cosΘ 夹角，就是 发光面法线 和 光线的夹角)

                
					单位：W/sr*m^2 = cd/m^2 = nit（尼特）

                    ---
                    还能表达成：
                    -1- 入射
                        L(p,ω) = dE(p) / (dω * cosΘ)
                    -2- 出射
                        L(p,ω) = dI(p,ω) / (dA * cosΘ)
                    可以注意到，不管哪个计算，cos 值都出现在 分母上

                    ===
                    为什么此处的 cos 值出现在分母上呢 ？？？
                    :
                    也许需要反过来思考才行：
                    通常在图形学中，是要根据 radiance 去求 E 值的
                    此时 cos 会调到等死的左边:
                        dE(p,ω) = L(p,ω) * cosΘ * dω




# ---------------------------------------------- #
#             立体角  Solid Angle
# ---------------------------------------------- #
Ω (ω)

# --- 概念 ---
    半径为1的二维球面上的一小块区域的面积值。
    （此时由于半径=1，面积和立体角是相等的）

    当我们想要计算，三维空间中，一个物体在 一个球上的 立体角时，
        我们就应该把这个物体，投影到这个 球的单位球上（半径=1）
        然后求 投影的面积，这个面积就是 立体角。
    与之相等的方法2是：
        直接将物体投影到 目标球上（哪怕球半径 != 1）
        然后将求得的投影面积，除以 r^2

# --- 概念衍生 ---
    可以先思考 弧度，再思考立体角
    弧度：
        半径为1的圆上，一段弧线的长度，就是它所对应的夹角的 弧度值
    立体角：
        半径为1的球上，一个球面区域的面积，就是它所对应的 夹角的 立体角值

# --- 球体的 立体角 = 4pi ---
    因为 球面积 = 4.pi.r^2;
    当r=1，面积 = 4.pi;
    "半径为1时，面积就是立体角"
    所以，立体角 = 4.pi

# --- 球坐标 ---
    球坐标 通常用 两个角度来表达：
        Θ 代表 球上某点 与 z轴（up）形成的夹角    -- z轴 up
        Φ 代表 球上某点 与 x轴（right）形成的夹角 -- x轴 right

    这两个角度并不是平等的关系，尤其是在求 微分 时。

# --- 球表面 的 微元面积: dA ---
    dA = ( r * sinΘ * dΦ )*( r * dΘ )
       = r^2 * sinΘ * dΘ * dΦ

    注意这个公式中的 sinΘ，它反应了 Θ，Φ 两角度的 不平等关系
    这个 sinΘ，是整个 立体角 概念理解中，一个难点 !!!!!

# --- 单位立体角 公式 ---
    dω = dΩ = dA / r^2
       = sinΘ * dΘ * dΦ
    （球表面上的 微元面积A / 半径^2）
	单位：球面度/Steradian


# ---------------------------------------------- #
#        半球 cos 值的积分 == pi
# ---------------------------------------------- #
这是一个非常常见的概念：
    “在一个半球中，我们收集所有的 方向法线，计算每个方向法线 与 半球心法线的 cos 值
    然后所有这些 cos值 的积分，为 pi“
# 出现的地方：
- lambert BRDF 公式



# ---------------------------------------------- #
#         Fredholm Integral Equation  
#             弗雷德霍姆积分方程 
# ---------------------------------------------- #


# ---------------------------------------------- #
#              泰勒展开   
# ---------------------------------------------- #


# ---------------------------------------------- #
#              概率论
# ---------------------------------------------- #

-- random variable 	- 随机变量

-- probability 		- 概率

-- expected value - E
					期望值
					如果重复掷骰子无数次，最后可能获得的 单次平均值

-- probability density function (PDF)
					概率密度函数 p(x)
					===
					一条连续曲线，
					x轴值为 各个 随机变量的值
					y轴值为 x值对应的 概率
					---
					满足条件：
					p(x)>=0 and 积分(p(x)*dx) = 1
					---
					pdf 的期望值的计算： 
					E[x] = 积分( x * p(x) * dx )


-- function of a random variable
					随机变量 X 的函数 Y,
					Y = f(X)
					这个函数Y，也是一个随机变量
					===
					也可以求它的 期望值：
					E[Y] = E[f(X)] = 积分( f(x) * p(x) * dx )



# ---------------------------------------------- #
#               黎曼积分  （定积分）
# ---------------------------------------------- #
黎曼积分的目的，是求一条函数，在区间 [a,b] 之间的积分。
如果这个函数非常复杂，无法用公式表达，此时就可用上黎曼洛法：

思路就是每隔一段间距，对函数求y值，然后把这一小段当作一个矩形。
最后求得一个 近似值

黎曼积分 就是 定积分！



# ---------------------------------------------- #
#     Monte Carlo methods      蒙特卡罗方法  
#     Monte Carlo Integration  蒙特卡罗积分    
# ---------------------------------------------- #
蒙特卡洛积分的目的，是求一条函数，在区间 [a,b] 之间的积分。
如果这个函数非常复杂，无法用公式表达，此时就要用上蒙特卡洛法

思路就是，每次都随机抽取一次样本，将这个样本值当作目标值去计算
重复这个 抽取的过程 n 次，最后求平均值

具体到积分运算中就是：
	--
	每次都随机选择一个 x，以它对应的y值 作为一个矩形的高，
	计算这个矩形的面积：f(x)*x, 然后我们认为这个 矩形面积，就是积分的结果
	--
	重复上面的步骤n次，求平均值，
	这个值会非常接近 真正的曲线积分结果



# ---------------------------------------------- #
#        low discrepancy sequences
#               低差异序列
# ---------------------------------------------- #
不同种类的随机数，导致的渲染效果不同
这方面的研究  



# ---------------------------------------------- #
#        Volumetric and Translucency   
#            体积云，次表面散射 
# ---------------------------------------------- #


++
每个频率的光线都有对应的系数，在用 RGB渲染时，
每个颜色都有各自的 吸收和散射系数


=========================
---
Participating Media：参与介质，散射介质
	

---
Phase Functions: 相位方程
	（可以理解为 空间中的 BSDF）
	定义了空间中，一个点的两个方向，发生散射的概率

	P(Θa, Θb);
		参数 Θa, 光线原始方向
		参数 Θb, 光转折后的方向
		（参数也可以是两个方向的夹角）
		函数返回一个概率值，表示能发生上述转折的 概率值。
	---
	相位函数 所有返回值的 积分 应该是 1。



--- 
σa -- 吸收系数 (absorption)
	介质空间中，每单位长度中，光子被吸收的概率

---
σs -- 散射系数 (scattering)
	介质空间中，每单位长度中，光子被散射的概率（传播方向被改变）
	包括 其他方向的光线 入射到当前方向的概率
	也包括 当前方向，出射到其他方向的概率

---
σt -- 衰减系数 ()
	= 吸收系数 + 散射系数
	介质空间中，每单位长度中，光子被吸收，或出射到其他方向的总概率



---
BSSRDF
bidirectional surface scattering reflectance 
distribution function
	和 BRDF 不同之处在于，BSSRDF 可以指定不同光线 入射位置 和出射位置。


---
normalized diffusion -- 归一化散射

multiple scattering -- 多重散射

single scattering -- 直接散射

diffuse mean free path - 平均散射距离

importance sample -- 重点采样

variance -- 方差









# ---------------------------------------------- #
#              
# ---------------------------------------------- #


# ---------------------------------------------- #
#              
# ---------------------------------------------- #



# ---------------------------------------------- #
#              
# ---------------------------------------------- #





